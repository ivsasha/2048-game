const t=new class{constructor(t){this.size=4,this.board=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let s=0;s<this.size;s++){let e=[...this.board[s]],i=[];for(let t=0;t<this.size;t++)0!==this.board[s][t]&&i.push(this.board[s][t]);let r=[];for(let t=0;t<i.length;t++)i[t]===i[t+1]?(r.push(2*i[t]),this.score+=2*i[t],t++):r.push(i[t]);for(;r.length<this.size;)r.push(0);JSON.stringify(e)!==JSON.stringify(r)&&(this.board[s]=r,t=!0)}t&&this.addRandomTile()}moveRight(){if("playing"!==this.status)return;let t=!1;for(let s=0;s<this.size;s++){let e=[...this.board[s]],i=[...e].reverse().filter(t=>0!==t),r=[];for(let t=0;t<i.length;t++)i[t]===i[t+1]?(r.push(2*i[t]),this.score+=2*i[t],t++):r.push(i[t]);for(;r.length<this.size;)r.push(0);let a=r.reverse();JSON.stringify(e)!==JSON.stringify(a)&&(this.board[s]=a,t=!0)}t&&this.addRandomTile()}moveUp(){if("playing"!==this.status)return;let t=!1;for(let s=0;s<this.size;s++){let e=[];for(let t=0;t<this.size;t++)e.push(this.board[t][s]);let i=e.filter(t=>0!==t),r=[];for(let t=0;t<i.length;t++)i[t]===i[t+1]?(r.push(2*i[t]),this.score+=2*i[t],t++):r.push(i[t]);for(;r.length<this.size;)r.push(0);for(let e=0;e<this.size;e++)this.board[e][s]!==r[e]&&(t=!0),this.board[e][s]=r[e]}t&&this.addRandomTile()}moveDown(){if("playing"!==this.status)return;let t=!1;for(let s=0;s<this.size;s++){let e=[];for(let t=this.size-1;t>=0;t--)e.push(this.board[t][s]);let i=e.filter(t=>0!==t),r=[];for(let t=0;t<i.length;t++)i[t]===i[t+1]?(r.push(2*i[t]),this.score+=2*i[t],t++):r.push(i[t]);for(;r.length<this.size;)r.push(0);for(let e=this.size-1;e>=0;e--){let i=r[this.size-1-e];this.board[e][s]!==i&&(t=!0,this.board[e][s]=i)}}t&&this.addRandomTile()}getScore(){return this.score}getState(){return this.board}getStatus(){return this.isGameWon()?this.status="win":this.isGameLost()?this.status="lose":this.isGameInProgress()?this.status="playing":this.status="idle",this.status}start(){this.status="playing",this.addRandomTile(),this.addRandomTile()}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle",this.start()}addRandomTile(){let t=this.getEmptyTiles();if(0===t.length)return;let s=Math.floor(Math.random()*t.length),[e,i]=t[s];this.board[e][i]=.9>Math.random()?2:4,this.score+=this.board[e][i],this.status="playing"}getEmptyTiles(){let t=[];for(let s=0;s<this.size;s++)for(let e=0;e<this.size;e++)0===this.board[s][e]&&t.push([s,e]);return t}isGameOver(){if(this.getEmptyTiles().length>0)return!1;for(let t=0;t<this.size;t++)for(let s=0;s<this.size;s++)if(s<this.size-1&&this.board[t][s]===this.board[t][s+1]||t<this.size-1&&this.board[t][s]===this.board[t+1][s])return!1;return!0}isGameWon(){for(let t=0;t<this.size;t++)for(let s=0;s<this.size;s++)if(2048===this.board[t][s])return!0;return!1}isGameLost(){return this.isGameOver()&&!this.isGameWon()}isGameInProgress(){return"playing"===this.status}};document.addEventListener("keydown",s=>{if("playing"===t.getStatus()){switch(s.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}e()}});const s=document.querySelector(".start");s.addEventListener("click",()=>{"playing"===t.getStatus()&&(t.restart(),e(),s.classList.remove("start"),s.classList.add("restart"),s.textContent="Restart"),"win"===t.getStatus()&&(t.restart(),e(),s.classList.remove("start"),s.classList.add("restart"),s.textContent="Restart"),"lose"===t.getStatus()&&(t.restart(),e(),s.classList.remove("start"),s.classList.add("restart"),s.textContent="Restart"),"idle"===t.getStatus()&&(t.start(),e(),s.classList.remove("start"),s.classList.add("restart"),s.textContent="Restart")});const e=()=>{let s=document.querySelectorAll(".field-cell");s.forEach(t=>{t.textContent="",t.classList.remove("field-cell--2"),t.classList.remove("field-cell--4"),t.classList.remove("field-cell--8"),t.classList.remove("field-cell--16"),t.classList.remove("field-cell--32"),t.classList.remove("field-cell--64"),t.classList.remove("field-cell--128"),t.classList.remove("field-cell--256"),t.classList.remove("field-cell--512"),t.classList.remove("field-cell--1024"),t.classList.remove("field-cell--2048")});for(let e=0;e<t.size;e++)for(let i=0;i<t.size;i++){let r=e*t.size+i,a=t.board[e][i];0!==a&&(s[r].textContent=a,s[r].classList.add("field-cell"),s[r].classList.add(`field-cell--${a}`))}document.querySelector(".game-score").textContent=`${t.score}`;let e=document.querySelector(".message-win"),i=document.querySelector(".message-lose"),r=document.querySelector(".message-start");"win"===t.getStatus()&&(e.classList.remove("hidden"),i.classList.add("hidden"),r.classList.add("hidden")),"lose"===t.getStatus()&&(e.classList.add("hidden"),i.classList.remove("hidden"),r.classList.add("hidden")),"playing"===t.getStatus()&&(e.classList.add("hidden"),i.classList.add("hidden"),r.classList.add("hidden"))};
//# sourceMappingURL=index.0180f80c.js.map
